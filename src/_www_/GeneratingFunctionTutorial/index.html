<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.7: http://docutils.sourceforge.net/" />
<title>Generating Fucntion Tutorial</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 6253 2010-03-02 00:24:53Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="generating-fucntion-tutorial">
<h1 class="title">Generating Fucntion Tutorial</h1>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>
<!-- <script type="text/javascript" src="http://localhost:8000/media/mathjax/MathJax.js?config=default"></script> -->
<link rel="stylesheet" href="math.css" type="text/css"><p>Let's begin with a very famous sequence: <span class="mathjaxlatex">\(0\ 1\ 1\ 2\ 3\ 5\ 8\ 13\ 21\ 34\ 55\ 89\ 144\)</span> .
They are <em>Fibonacci numbers</em>, which can be defined as:</p>
<span class="eqno">(1)</span><div class="mathjaxlatex" id="equation-fibo">
\[\begin{align}
\def\phihat{\rlap{\phi}{\phantom{\hspace{0.4ex}}\widehat{\phantom{\varphi}}}}
\def\phihats{\rlap{\phi}{\phantom{\hspace{0.1ex}}\widehat{\phantom{\varphi}}}}
\def\phia{\phi}
\def\phib{\varphi}
\def\phic{\phib}
F_{n}=\begin{cases}
0 &amp; n=0\\
1 &amp; n=1\\
F_{n-1}+F_{n-2} &amp; n&gt;1
\end{cases}
\end{align}\]</div>
<p>This is a recursive definition, which is good, but it's not straightforward enough.
For example, if we want to know <span class="mathjaxlatex">\(F_{100}\)</span>, we'll have to calculate
<span class="mathjaxlatex">\(F_{0}\)</span>, <span class="mathjaxlatex">\(F_{1}\)</span>, <span class="mathjaxlatex">\(\ldots\)</span>, <span class="mathjaxlatex">\(F_{98}\)</span> and <span class="mathjaxlatex">\(F_{99}\)</span>.
This is a lot of math to do. Is there any better solution? Or, is there a <em>closed form</em> for Fibonacci numbers?</p>
<p>Fortunately the answer is <em>yes</em>, and (unsurprisingly) <em>generating function</em> is such a tool to solve such kinda recurrence.</p>
<p>Generating function is smart and subtle. The only way to understand it is to see how it works by an example.
Here in this tutorial, I'll show you how generating function solves Fibonacci numbers recurrence.</p>
<p>Generally speaking, four steps are needed to solve a recurrence via generating function:</p>
<ol class="arabic simple">
<li>Write down a single equation that expresses <span class="mathjaxlatex">\(g_{n}\)</span> in terms of other elements of the sequence
(assuming that <span class="mathjaxlatex">\(g_{-1}=g_{-2}=\cdots=0\)</span>).</li>
<li>Multiply both sides of the equation by <span class="mathjaxlatex">\(z^{n}\)</span> and sum over all <span class="mathjaxlatex">\(n\)</span>. This gives,
on the left, the sum <span class="mathjaxlatex">\(G(z)=\sum_{n}g_{n}z^{n}\)</span>, which is the generating function <span class="mathjaxlatex">\(G(z)\)</span>.
The right-hand side should be manipulated so that it becomes some other expression involving <span class="mathjaxlatex">\(G(z)\)</span>.</li>
<li>Solve the resulting equation, getting a closed form for <span class="mathjaxlatex">\(G(z)\)</span>.</li>
<li>Expand <span class="mathjaxlatex">\(G(z)\)</span> into a power series and read off the coefficient of <span class="mathjaxlatex">\(z^n\)</span>; this is a closed form for <span class="mathjaxlatex">\(g_n\)</span>.</li>
</ol>
<p>Let's apply these steps to Fibonacci numbers.</p>
<div class="section" id="step-1">
<h1>Step 1</h1>
<p>At the beginning of this tutorial, we have seen the recursive definition of Fibonacci numbers (equation <a href="#equation-fibo">(1)</a>), but it is not <em>a single equation</em>.
So let's simplify it:</p>
<span class="eqno">(2)</span><div class="mathjaxlatex" id="equation-single">
\[g_{n}=g_{n-1}+g_{n-2}+[n=1]\]</div>
<p>Note that:</p>
<ol class="arabic simple">
<li>We use <span class="mathjaxlatex">\(g_{n}\)</span> instead of <span class="mathjaxlatex">\(F_{n}\)</span>.</li>
<li><span class="mathjaxlatex">\([n=1]\)</span> is the trick to make <em>a single equation</em>, it is defined as <span class="mathjaxlatex">\([n=m] = \begin{cases} 1 & n=m\\ 0 & n\neq m \end{cases}\:\)</span>,
therefore <span class="mathjaxlatex">\([n=1]\)</span> equals <span class="mathjaxlatex">\(1\)</span> iff <span class="mathjaxlatex">\(n=1\)</span>, which makes <a href="#equation-single">(2)</a> hold for any <span class="mathjaxlatex">\(n\ge 0\)</span>.</li>
</ol>
</div>
<div class="section" id="step-2">
<h1>Step 2</h1>
<p>Let's multiply both sides of equation <a href="#equation-single">(2)</a> by <span class="mathjaxlatex">\(z^{n}\)</span>:</p>
<div class="mathjaxlatex">
\[g_{n}z^{n} = g_{n-1}z^{n} + g_{n-2}z^{n} + [n=1]z^{n}\]</div>
<div class="mathjaxlatex">\[\]</div>
<p>and sum over all <span class="mathjaxlatex">\(n\)</span>:</p>
<div class="mathjaxlatex">
\[\begin{align}
G(z) = \sum_{n}g_{n}z^{n} &amp;= \sum_{n}g_{n-1}z^{n} + \sum_{n}g_{n-2}z^{n} + \sum_{n}[n=1]z^{n} \\
                          &amp;= n\sum_{n}g_{n-1}z^{n-1} + n^2\sum_{n}g_{n-2}z^{n-2} + z \\
                          &amp;= n\sum_{n}g_{n}z^{n} + n^2\sum_{n}g_{n}z^{n} + z \\
                          &amp;= zG(z)+z^{2}G(z)+z
\end{align}\]</div>
<div class="mathjaxlatex">\[\]</div>
<p>Please keep in your mind that <span class="mathjaxlatex">\(G(z)=\sum_{n}g_{n}z^{n}=g_0+g_1z+g_2z^2+\cdots\)</span>, that is to say,
if we denote <span class="mathjaxlatex">\(G(z)\)</span> as a power series, then the coefficients of <span class="mathjaxlatex">\(z^n\)</span> will be <span class="mathjaxlatex">\(F_n\)</span>.</p>
</div>
<div class="section" id="step-3">
<h1>Step 3</h1>
<p>Solve the equation <span class="mathjaxlatex">\(G(z)=zG(z)+z^{2}G(z)+z\)</span>, getting a closed form for <span class="mathjaxlatex">\(G(z)\)</span>:</p>
<div class="mathjaxlatex">
\[G(z)=\frac{z}{1-z-z^{2}}\]</div>
</div>
<div class="section" id="step-4">
<h1>Step 4</h1>
<p>Here comes the hardest part: to expand <span class="mathjaxlatex">\(G(z)\)</span> into a power series.
How can we do this? Well, there are more than one way to achieve it, but as to this Fibonacci question, there is a simple but smart way.</p>
<p>You may recall that</p>
<span class="eqno">(3)</span><div class="mathjaxlatex" id="equation-alpha">
\[\frac{1}{1-\alpha z}=1+\alpha z+\alpha^2 z^2+\alpha^3 z^3+\cdots\]</div>
<p>Similarly we have</p>
<span class="eqno">(4)</span><div class="mathjaxlatex" id="equation-beta">
\[\frac{1}{1-\beta z}=1+\beta z+\beta^2 z^2+\beta^3 z^3+\cdots\]</div>
<p>If we add <a href="#equation-alpha">(3)</a> <span class="mathjaxlatex">\(\times A\)</span> and <a href="#equation-beta">(4)</a> <span class="mathjaxlatex">\(\times B\)</span>, the left is</p>
<div class="mathjaxlatex">
\[\frac{A}{1-\alpha z}+\frac{B}{1-\beta z}=\frac{A+B+(-A\beta-B\alpha)z}{1-(\alpha+\beta)z+\alpha\beta z^2}\]</div>
<p>and the right is</p>
<div class="mathjaxlatex">
\[(A+B) + (A\alpha+B\beta)z + (A\alpha^2+B\beta^2)z^2 + \cdots\]</div>
<p>Then we realize that if we find the solutions to these two equations:</p>
<span class="eqno">(5)</span><div class="mathjaxlatex" id="equation-two">
\[\begin{align}
      z &amp;= A+B+(-A\beta-B\alpha)z \\
1-z-z^2 &amp;= 1-(\alpha+\beta)z+\alpha\beta z^2
\end{align}\]</div>
<p>then</p>
<div class="mathjaxlatex">
\[\begin{align}
G(z) = \frac{z}{1-z-z^2} &amp;= \frac{A+B+(-A\beta-B\alpha)z}{1-(\alpha+\beta)z+\alpha\beta z^2} \\
                         &amp;= \frac{A}{1-\alpha z}+\frac{B}{1-\beta z} \\
                         &amp;= (A+B) + (A\alpha+B\beta)z + (A\alpha^2+B\beta^2)z^2 + \cdots
\end{align}\]</div>
<div class="mathjaxlatex">\[\]</div>
<p>obviously <span class="mathjaxlatex">\(g_n=A\alpha^n+B\beta^n\)</span> and we'll be done.</p>
<p>Now all we have to do is to solve <a href="#equation-two">(5)</a>. Fortunately it's no hard job, first we realize that:</p>
<div class="mathjaxlatex">
\[\begin{align}
A+B             &amp;= 0 \\
-A\beta-B\alpha &amp;= 1 \\
\alpha+\beta    &amp;= 1 \\
\alpha\beta     &amp;= -1
\end{align}\]</div>
<p>therefore</p>
<div class="mathjaxlatex">
\[\begin{align}
\alpha &amp;= \frac{1\pm\sqrt{5}}{2} \\
\beta  &amp;= \frac{1\mp\sqrt{5}}{2} \\
A      &amp;= \pm\frac{1}{\sqrt{5}} \\
B      &amp;= \mp\frac{1}{\sqrt{5}}
\end{align}\]</div>
<!-- different phi
Φφϕᵠᵩ𝚽𝛗𝛟𝛷𝜑𝜙𝜱𝝋𝝓𝝫𝞅𝞍𝞥𝞿𝟇
\phia\phib\phic
\widehat{\phia}\hat{\phia}
\widehat{ϕ}\hat{ϕ} -->
<p>in which</p>
<ul class="simple">
<li><span class="mathjaxlatex">\(\alpha\)</span> and <span class="mathjaxlatex">\(\beta\)</span> are symmetric, so do <span class="mathjaxlatex">\(A\)</span> and <span class="mathjaxlatex">\(B\)</span>, so we can use <span class="mathjaxlatex">\(+\)</span> and <span class="mathjaxlatex">\(-\)</span> instead of <span class="mathjaxlatex">\(\pm\)</span> and <span class="mathjaxlatex">\(\mp\)</span>.</li>
<li><span class="mathjaxlatex">\(\frac{1+\sqrt{5}}{2}\)</span> is the <em>golden ratio</em>. In this article let's denote it as <span class="mathjaxlatex">\(\phia\)</span>.
<span class="mathjaxlatex">\(\frac{1-\sqrt{5}}{2}\)</span> will be denoted as <span class="mathjaxlatex">\(\phib\)</span>.</li>
</ul>
<p>Therefore</p>
<div class="mathjaxlatex">
\[\begin{align}
\alpha &amp;= \phia \\
\beta  &amp;= \phib \\
A      &amp;=  \frac{1}{\sqrt{5}} \\
B      &amp;= -\frac{1}{\sqrt{5}}
\end{align}\]</div>
<p>We can expand <span class="mathjaxlatex">\(G(z)\)</span> now:</p>
<div class="mathjaxlatex">
\[\begin{align}
G(z) &amp;= \frac{z}{1-z-z^{2}} \\
     &amp;= (A+B) + (A\alpha+B\beta)z + (A\alpha^2+B\beta^2)z^2 + \cdots \\
     &amp;= 0 + \frac{\phia-\phib}{\sqrt{5}}z + \frac{\phia^2-\phib^2}{\sqrt{5}}z^2 + \cdots
\end{align}\]</div>
<p>We can read off the coefficient of <span class="mathjaxlatex">\(z^n\)</span>:</p>
<div class="mathjaxlatex">
\[g_n=\frac{\phia^{n}-\phib^{n}}{\sqrt{5}}\]</div>
<p>In other words, the <span class="mathjaxlatex">\(n\)</span>th Fibonacci number is <span class="mathjaxlatex">\(\frac{\phia^{n}-\phic^{n}}{\sqrt{5}}\)</span>.</p>
</div>
<div class="section" id="summary">
<h1>Summary</h1>
<p>This is amazing.
We introduce <span class="mathjaxlatex">\(z^n\)</span>, then we use <span class="mathjaxlatex">\(z^n\)</span> and the unknown <span class="mathjaxlatex">\(g_n\)</span> (here <span class="mathjaxlatex">\(g_n\)</span> is <span class="mathjaxlatex">\(F_n\)</span>) to construct a <span class="mathjaxlatex">\(G(z)\)</span>,
finally we expand <span class="mathjaxlatex">\(G(z)\)</span> to get <span class="mathjaxlatex">\(g_n\)</span>.
It's like music: we have a subject, then we develop it and eventually we come back to it.</p>
<p>Please note that <span class="mathjaxlatex">\(z\)</span> and <span class="mathjaxlatex">\(G(z)\)</span> are meaningful only because we care about the coefficients of <span class="mathjaxlatex">\(z^n\)</span>.
We don't care what <span class="mathjaxlatex">\(z\)</span> is, neither do we care what <span class="mathjaxlatex">\(G(z)\)</span> is.
What we care is the expanded form of <span class="mathjaxlatex">\(G(z)\)</span>, so once we have a <span class="mathjaxlatex">\(G(z)\)</span>, we focus on how to expand it.</p>
<p>Generating function is beautiful and very powerful. You must have seen this in this tutorial.
If you want to learn more, I suggest you read <a class="citation-reference" href="#gkp" id="id1">[GKP]</a>.
This tutorial is actually a note I made when I read the book.
Fibonacci numbers are amazing. If you read <a class="citation-reference" href="#gkp" id="id2">[GKP]</a>, you'll find more discussions in Chapter 6 and Chapter 7.</p>
<table class="docutils citation" frame="void" id="gkp" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[GKP]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Ronald L. Graham, Donald E. Knuth, and Oren Patashnik, Concrete Mathematics: A Foundation for Computer Science. Addison-Wesley, 1989; second edition, 1994.</td></tr>
</tbody>
</table>
</div>
</div>
</body>
</html>

